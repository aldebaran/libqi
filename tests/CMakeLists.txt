## Copyright (c) 2012 Aldebaran Robotics. All rights reserved.
## Use of this source code is governed by a BSD-style license that can be
## found in the COPYING file.
if(${QIBUILD_VERSION} VERSION_GREATER "3.1")
  qi_create_test_helper(testlaunch         testlaunch.cpp)
  qi_create_test_helper(testlaunchloop     testlaunchloop.cpp)
  qi_create_test_helper(check_env          check_env.cpp)
  qi_create_test_helper(check_machineid    check_machineid.cpp)
  qi_create_test_helper(test_application   test_application.cpp)
else()
  qi_create_bin(testlaunch       NO_INSTALL testlaunch.cpp)
  qi_create_bin(testlaunchloop   NO_INSTALL testlaunchloop.cpp)
  qi_create_bin(check_env        NO_INSTALL check_env.cpp)
  qi_create_bin(check_machineid  NO_INSTALL check_machineid.cpp)
  qi_create_bin(test_application NO_INSTALL test_application.cpp)
endif()

qi_use_lib(testlaunchloop QI)
qi_use_lib(check_env QI)
qi_use_lib(check_machineid QI)
qi_use_lib(test_application QI)

set_target_properties(testlaunch PROPERTIES FOLDER tests)
set_target_properties(testlaunchloop PROPERTIES FOLDER tests)
set_target_properties(check_env  PROPERTIES FOLDER tests)
set_target_properties(test_application  PROPERTIES FOLDER tests)

qi_create_gtest(test_qipath      SRC test_qipath.cpp ../src/utils.cpp DEPENDS QI GTEST)
qi_create_gtest(test_qipath_from_bin SRC test_qipath.cpp ../src/utils.cpp
  DEPENDS QI GTEST)
qi_create_gtest(test_qilocal             SRC test_locale.cpp      DEPENDS QI GTEST)
qi_create_gtest(test_path_conf           SRC test_path_conf.cpp ../src/path_conf.cpp DEPENDS QI GTEST)
qi_create_gtest(test_qios                SRC test_qios.cpp        DEPENDS QI GTEST)
qi_create_gtest(test_qiatomic            SRC test_qiatomic.cpp    DEPENDS QI GTEST)
qi_create_gtest(test_shared_ptr          SRC test_shared_ptr.cpp  DEPENDS QI GTEST)
qi_create_gtest(test_thread              SRC test_thread.cpp      DEPENDS QI BOOST_THREAD)
qi_create_gtest(test_threadpool          SRC test_threadpool.cpp  DEPENDS QI BOOST_THREAD GTEST TIMEOUT 200)
qi_create_gtest(test_threadpool_nightly  SRC test_threadpool_nightly.cpp NIGHTLY DEPENDS QI BOOST_THREAD GTEST TIMEOUT 500)
qi_create_gtest(test_qilaunch            SRC test_qilaunch.cpp    DEPENDS QI GTEST)
qi_create_gtest(test_qilog_sync          SRC test_qilog_sync.cpp  DEPENDS QI GTEST)
qi_create_gtest(test_qilog_async         SRC test_qilog_async.cpp DEPENDS QI GTEST)
qi_create_gtest(test_future              SRC test_future.cpp      DEPENDS QI GTEST TIMEOUT 10)
qi_create_gtest(test_buffer              SRC test_buffer.cpp      DEPENDS QI GTEST TIMEOUT 10)
qi_create_gtest(test_bufferreader        SRC test_bufferreader.cpp      DEPENDS QI GTEST TIMEOUT 10)
qi_create_gtest(test_version             SRC test_version.cpp     DEPENDS QI GTEST TIMEOUT 10)
qi_create_gtest(test_macro               SRC test_macro.cpp     DEPENDS QI GTEST TIMEOUT 10)
